## Пример функции для записи данных из IoT Core в PostgreSQL

В качестве примера источника данных в сценариях используются данные датчика воздуха, измеряющего следующие параметры:
 - Температура
 - Влажность
 - Давление
 - Уровень содержания СO2

 Датчик выдает результат в формате JSON. Например:

   ```
   {
    "DeviceId":"0e3ce1d0-1504-4325-972f-55c961319814",
    "TimeStamp":"2020-05-21T22:53:16Z",
    "Values":[
        {"Type":"Float","Name":"Humidity","Value":"25.281837"},
        {"Type":"Float","Name":"CarbonDioxide","Value":"67.96608"},
        {"Type":"Float","Name":"Pressure","Value":"110.7021"},
        {"Type":"Float","Name":"Temperature","Value":"127.708824"}
        ]
   }
   ```

[Функция](myfunction.py) использует точку входа myfunction.msgHandler.

Таблица в базе данных автоматически создается при первом вызове функции (метод `makeCreateTableStatement`).

Подробнее данный сценарий описан в [документации](https://cloud.yandex.ru/docs/iot-core/solutions/data-recording)

В функции используются следующие переменные окружения:

- VERBOSE_LOG - если True, то будет выводиться подробный журнал выполнения функции
- DB_HOSTNAME - имя хоста базы данных PostgreSQL для подключения
- DB_PORT - порт для подключения к базе данных
- DB_NAME - имя базы данных для подключения
- DB_USER - имя пользователя для подключения к базе данных
- DB_PASSWORD - пароль для подключения к базе данных

Для работы данной функции нужно создать и настройить [триггер], который будтет вызывать ее при каждом новом сообщении от устройства.

## Дополнительная информация

Рекомендуем также ознакомиться с [примером использования Terraform]() для автоматическиого разворачивания ресурсов данного сценария в Яндекс.Облаке.
